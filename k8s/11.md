# Task 1: Kubernetes Secrets and Resource Management

## Create `devops-secret` :

```shell
$  kubectl create secret generic devops-secret --from-literal=username='test' --from-literal=password='test'
secret/devops-secret created
```

## Describe `devops-secret` :

```shell
$   kubectl describe secret devops-secret
Name:         devops-secret
Namespace:    default
Labels:       <none>
Annotations:  <none>

Type:  Opaque

Data
====
password:  4 bytes
username:  4 bytes
```

## Get `devops-secret` :

```shell
$   kubectl get secret devops-secret -o jsonpath='{.data}'
{"password":"dGVzdA==","username":"dGVzdA=="}
```

## Encoding `devops-secret` :

```shell
$   echo 'dGVzdA==' | base64 --decode
test
```

## Installing app-python with secrets:

```shell
$   helm secrets install app-python ./app-python/ -n default -f ./secrets.yaml
[helm-secrets] Decrypt: ./secrets.yaml
NAME: app-python
LAST DEPLOYED: Tue Apr  16 21:23:18 2024
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
     NOTE: It may take a few minutes for the LoadBalancer IP to be available.
           You can watch the status of by running 'kubectl get --namespace default svc -w app-python'
  export SERVICE_IP=$(kubectl get svc --namespace default app-python --template "{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}")
  echo http://$SERVICE_IP:8000

[helm-secrets] Removed: ./secrets.yaml.dec
```

## Get verifications:

```shell
$   kubectl get po
NAME                                   READY   STATUS      RESTARTS   AGE
app-python-68b4b9786c-lq7jn            1/1     Running     0          2m57s
post-install-hook                      0/1     Completed   0          2m57s
pre-install-hook                       0/1     Completed   0          3m5s
```

```shell
$   kubectl exec my-python-app-55b96bd467-k4z89 -- printenv | grep MY_PASSWORD
MY_PASSWORD=test
```

# Task 2: Vault Secret Management System

## `Kubectl get po` :

```shell
$   kubectl get po
kubectl get po
NAME                                   READY   STATUS      RESTARTS   AGE
app-python-68b4b9786c-lq7jn            1/1     Running     0          7m22s
post-install-hook                      0/1     Completed   0          7m22s
pre-install-hook                       0/1     Completed   0          7m30s
vault-0                                1/1     Running     0          1m15s
vault-agent-injector-dbfc5cd77-hxgjx   1/1     Running     0          1m15s
```

## Following the tutorial :

```shell
$ kubectl exec -it vault-0 -- sh
/ $ vault secrets enable -path=internal kv-v2
Success! Enabled the kv-v2 secrets engine at: internal/
/ $ vault kv put internal/database/config username="db-readonly-username" password="db-secret-password"
======== Secret Path ========
internal/data/database/config

======= Metadata =======
Key                Value
---                -----
created_time       2024-04-16T21:35:58.474234348Z
custom_metadata    <nil>
deletion_time      n/a
destroyed          false
version            1
/ $ vault kv get internal/database/config
======== Secret Path ========
internal/data/database/config

======= Metadata =======
Key                Value
---                -----
created_time       2024-04-16T21:35:58.474234348Z
custom_metadata    <nil>
deletion_time      n/a
destroyed          false
version            1

====== Data ======
Key         Value
---         -----
password    db-secret-password
username    db-readonly-username
/ $ vault auth enable kubernetes
Success! Enabled kubernetes auth method at: kubernetes/
```
