# Lab 14

## Describing components
The Kube Prometheus Stack is a collection of tools designed to monitor Kubernetes clusters using Prometheus and Grafana. It consists of several key components, each playing a specific role in the monitoring process:

1. Prometheus: This is the core component of the stack. Prometheus is a time-series database that collects metrics from various endpoints in the Kubernetes cluster. It scrapes metrics at regular intervals and stores them for later querying and visualization.
2. Alertmanager: Alertmanager is responsible for handling alerts generated by Prometheus. It allows you to configure alerting rules and routes alerts to different receivers (such as email, Slack, etc.) based on predefined conditions.
3. Node Exporter: Node Exporter collects system-level metrics from Kubernetes nodes, such as CPU usage, memory usage, disk utilization, and network statistics. These metrics provide insights into the health and performance of individual nodes in the cluster.
4. kube-state-metrics: This component generates metrics about the state of Kubernetes objects (pods, nodes, deployments, etc.). It helps in monitoring the overall health and status of resources running in the cluster.
5. Grafana: Grafana is a visualization tool that connects to Prometheus to create dashboards for monitoring and analyzing metrics. It allows users to build custom dashboards with graphs, charts, and alerts based on the collected data.
6. Prometheus Operator: The Prometheus Operator simplifies the deployment and management of Prometheus instances in a Kubernetes cluster. It automates tasks like provisioning, scaling, and configuration updates, making it easier to maintain a Prometheus setup.

By combining these components, the Kube Prometheus Stack provides a comprehensive monitoring solution for Kubernetes clusters, enabling users to track performance metrics, set up alerts for potential issues, and visualize data in a user-friendly way through Grafana dashboards.

## Install helm charts

```bash
~ ❯❯❯ kubectl get po,sts,svc,pvc,cm
NAME                                                         READY   STATUS    RESTARTS   AGE
pod/alertmanager-prom-stack-kube-prometheus-alertmanager-0   2/2     Running   0          13m
pod/prom-stack-grafana-548c88d5fb-xrlpc                      3/3     Running   0          13m
pod/prom-stack-kube-prometheus-operator-65bcd85d5d-rkr9n     1/1     Running   0          13m
pod/prom-stack-kube-state-metrics-5655547b7d-6cqfj           1/1     Running   0          13m
pod/prom-stack-prometheus-node-exporter-nrxhl                1/1     Running   0          13m
pod/prometheus-prom-stack-kube-prometheus-prometheus-0       2/2     Running   0          13m

NAME                                                                    READY   AGE
statefulset.apps/alertmanager-prom-stack-kube-prometheus-alertmanager   1/1     13m
statefulset.apps/prometheus-prom-stack-kube-prometheus-prometheus       1/1     13m

NAME                                              TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE
service/alertmanager-operated                     ClusterIP   None             <none>        9093/TCP,9094/TCP,9094/UDP   13m
service/kubernetes                                ClusterIP   10.96.0.1        <none>        443/TCP                      14m
service/prom-stack-grafana                        ClusterIP   10.101.229.164   <none>        80/TCP                       13m
service/prom-stack-kube-prometheus-alertmanager   ClusterIP   10.99.95.57      <none>        9093/TCP,8080/TCP            13m
service/prom-stack-kube-prometheus-operator       ClusterIP   10.99.253.101    <none>        443/TCP                      13m
service/prom-stack-kube-prometheus-prometheus     ClusterIP   10.96.29.192     <none>        9090/TCP,8080/TCP            13m
service/prom-stack-kube-state-metrics             ClusterIP   10.102.68.251    <none>        8080/TCP                     13m
service/prom-stack-prometheus-node-exporter       ClusterIP   10.104.236.1     <none>        9100/TCP                     13m
service/prometheus-operated                       ClusterIP   None             <none>        9090/TCP                     13m

NAME                                                                     DATA   AGE
configmap/kube-root-ca.crt                                               1      14m
configmap/prom-stack-grafana                                             1      13m
configmap/prom-stack-grafana-config-dashboards                           1      13m
configmap/prom-stack-kube-prometheus-alertmanager-overview               1      13m
configmap/prom-stack-kube-prometheus-apiserver                           1      13m
configmap/prom-stack-kube-prometheus-cluster-total                       1      13m
configmap/prom-stack-kube-prometheus-controller-manager                  1      13m
configmap/prom-stack-kube-prometheus-etcd                                1      13m
configmap/prom-stack-kube-prometheus-grafana-datasource                  1      13m
configmap/prom-stack-kube-prometheus-grafana-overview                    1      13m
configmap/prom-stack-kube-prometheus-k8s-coredns                         1      13m
configmap/prom-stack-kube-prometheus-k8s-resources-cluster               1      13m
configmap/prom-stack-kube-prometheus-k8s-resources-multicluster          1      13m
configmap/prom-stack-kube-prometheus-k8s-resources-namespace             1      13m
configmap/prom-stack-kube-prometheus-k8s-resources-node                  1      13m
configmap/prom-stack-kube-prometheus-k8s-resources-pod                   1      13m
configmap/prom-stack-kube-prometheus-k8s-resources-workload              1      13m
configmap/prom-stack-kube-prometheus-k8s-resources-workloads-namespace   1      13m
configmap/prom-stack-kube-prometheus-kubelet                             1      13m
configmap/prom-stack-kube-prometheus-namespace-by-pod                    1      13m
configmap/prom-stack-kube-prometheus-namespace-by-workload               1      13m
configmap/prom-stack-kube-prometheus-node-cluster-rsrc-use               1      13m
configmap/prom-stack-kube-prometheus-node-rsrc-use                       1      13m
configmap/prom-stack-kube-prometheus-nodes                               1      13m
configmap/prom-stack-kube-prometheus-nodes-darwin                        1      13m
configmap/prom-stack-kube-prometheus-persistentvolumesusage              1      13m
configmap/prom-stack-kube-prometheus-pod-total                           1      13m
configmap/prom-stack-kube-prometheus-prometheus                          1      13m
configmap/prom-stack-kube-prometheus-proxy                               1      13m
configmap/prom-stack-kube-prometheus-scheduler                           1      13m
configmap/prom-stack-kube-prometheus-workload-total                      1      13m
configmap/prometheus-prom-stack-kube-prometheus-prometheus-rulefiles-0   35     13m
```

## Utilize Grafana Dashboards

![](.img/14_cpu.png)
![](.img/14_cpu_load.png)
![](.img/14_kubelet.png)
![](.img/14_memory.png)
![](.img/14_memory_utili.png)
![](.img/14_networking.png)

